<button type="button" class="product-card" tabindex="0" [class.not-active]="!isActive()"
  [class.out-of-stock]="!isInStock()">
  
  @if (message()) {
  <div class="toast" role="status" aria-live="polite">
    {{ message() }}
  </div>
  }

  @if (isEditing()) {
  <h1>Edit Product</h1>
  <form [formGroup]="updatedProductForm" (ngSubmit)="onSave()">
    <div class="status-toggle status-toggle--top" role="group" aria-label="Active status">
      <button type="button" 
        [class.selected]="isEditActive"
        (click)="setActive(true)"
        [attr.aria-pressed]="isEditActive">
        Active
      </button>
      <button type="button" [class.selected]="isEditNotActive" (click)="setActive(false)"
        [attr.aria-pressed]="isEditNotActive">
        Not Active
      </button>
    </div>

    <label>
      Name
      <input type="text" formControlName="name" />
    </label>
    <label>
      Price
      <input type="number" formControlName="price" min="0" step="0.01" inputmode="numeric"/>
    </label>

    <div class="status-toggle status-toggle--bottom" role="group" aria-label="Stock status">
      <button type="button" [class.selected]="isEditInStock" (click)="setInStock(true)"
        [attr.aria-pressed]="isEditInStock">
        In Stock
      </button>
      <button type="button" [class.selected]="isEditOutOfStock" (click)="setInStock(false)"
        [attr.aria-pressed]="isEditOutOfStock">
        Out of Stock
      </button>
    </div>

    <button type="button" class="cancel" (click)="cancelEdit()">Cancel</button>
    <button type="submit" [disabled]="updatedProductForm.invalid">Save</button>
  </form>
  } @else {
  @if (authService.isAdmin()){
  <div class="card-status-row">
    <span class="product-badge">
      @if (isActive()) {
      Active
      } @else {
      Not Active
      }
    </span>
  </div>
  }
  <h2>{{ product().name }}</h2>
  <div class="product-details">
    <span class="product-price">{{ product().price }}</span>
    <span class="product-badge">
      @if (isInStock()) {
      In Stock
      } @else {
      Out of Stock
      }
    </span>
  </div>
  @if (authService.isAdmin()) {
  <div class="admin-actions">
    <button type="button" class="update-btn" (click)="openEditForm()">Update</button>
  </div>
  }
  }
</button>